<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Ocorrência</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = { /* ... seu config ... */ };
    </script>
</head>
<body class="bg-dark-primary min-h-screen p-8">
    <div id="mensagem-status" class="hidden fixed top-4 right-4 p-4 rounded-lg shadow-xl text-text-light z-50"></div>
    <div class="max-w-7xl mx-auto">
        <header class="w-full text-center mb-8 mt-4">
            <h1 class="text-3xl sm:text-4xl lg:text-5xl font-extrabold text-accent">
                SISTEMA DE GESTÃO DE CONVIVÊNCIA ESCOLAR
            </h1>
            <h2 id="titulo-edicao" class="text-xl sm:text-2xl text-text-light mt-2 font-light border-b border-gray-700 pb-2 inline-block">
                Carregando...
            </h2>
             <div class="mt-4 flex justify-center">
                 <button type="button" onclick="window.history.back()"
                         class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg flex items-center space-x-2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 15l-3-3m0 0l3-3m-3 3h8M3 12a9 9 0 1118 0 9 9 0 01-18 0z"></path></svg>
                    <span>Voltar à Lista</span>
                </button>
             </div>
        </header>

        <main class="w-full max-w-5xl mx-auto">
            <form id="edicao-form">
                <div class="bg-dark-secondary p-6 rounded-xl shadow-lg mb-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="display-aluno" class="text-sm">Aluno</label>
                            <input type="text" id="display-aluno" class="w-full input-bg rounded-lg p-2" readonly>
                        </div>
                        <div>
                            <label for="display-sala" class="text-sm">Sala</label>
                            <input type="text" id="display-sala" class="w-full input-bg rounded-lg p-2" readonly>
                        </div>
                        <div>
                            <label for="display-tutor" class="text-sm">Tutor (Aluno)</label>
                            <input type="text" id="display-tutor" class="w-full input-bg rounded-lg p-2" readonly>
                        </div>
                         <div>
                            <label for="display-professor" class="text-sm">Professor (Registro)</label>
                            <input type="text" id="display-professor" class="w-full input-bg rounded-lg p-2" readonly>
                        </div>
                         <div class="md:col-span-2">
                            <label for="display-registro" class="text-sm">Data/Hora do Registro</label>
                            <input type="text" id="display-registro" class="w-full input-bg rounded-lg p-2" readonly>
                        </div>
                    </div>
                </div>

                </form>
        </main>
    </div>
</body>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id'); // Este ID agora é o 'numero'
        const modo = urlParams.get('modo');
        
        if (!id) {
            alert("ID da ocorrência não encontrado!");
            return;
        }
        carregarDetalhesOcorrencia(id, modo);
    });

    async function carregarDetalhesOcorrencia(id, modo) {
        try {
            // A rota da API deve ser capaz de buscar uma ocorrência pelo seu número
            const response = await fetch(`/api/ocorrencias/${id}`);
            if (!response.ok) {
                throw new Error("Falha ao carregar detalhes.");
            }
            const data = await response.json();
            preencherFormulario(data);
            // ... (restante da sua lógica)
        } catch (error) {
            alert("Erro ao carregar detalhes: " + error.message);
        }
    }

    function preencherFormulario(data) {
        document.getElementById('display-aluno').value = data.aluno_nome || 'N/A';
        document.getElementById('display-sala').value = data.sala_nome || 'N/A';
        // ... (preencher outros campos)
    }
</script>
</html>
